#!/usr/bin/env bash

PROJECT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)/.."
INSTALL_DIR="$1"
shift

if [ -n "$INSTALL_DIR" ]; then
  if [ ! -d "$INSTALL_DIR" ]; then
    echo "Error: Not a valid directory: $INSTALL_DIR"
    exit 1
  fi
elif [ -n "$BIN_HOME" ] && [ -d "$BIN_HOME" ]; then
  INSTALL_DIR="${BIN_HOME}/lib"
else
  echo "Error: You must provide a valid directory to install to."
  exit 1
fi

echo "Installing into $INSTALL_DIR"

echo "Installing Radio Module"
"$PROJECT_DIR/bin/gradlew" radio:installDist || exit 1
cp -rv "$PROJECT_DIR/radio/build/install/mt-radio" "$INSTALL_DIR/" || exit 1

echo ""
echo "Successfully installed"
